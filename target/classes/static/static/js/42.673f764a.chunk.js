"use strict";(self.webpackChunkcar_wash_management=self.webpackChunkcar_wash_management||[]).push([[42],{20042:function(e,t,a){a.r(t);var i=a(72791),n=a(61889),o=a(48550),r=a(20890),l=a(94294),c=a(64554),s=a(13400),h=a(27247),d=a(23735),m=a(91923),g=a(95587),p=a.n(g),x=a(80184);t.default=e=>{let{data:t,updateData:a,photos:g,updatePhotos:u,zipFile:v}=e;const[j,Z]=(0,i.useState)(!1),[f,w]=(0,i.useState)(null),[b,y]=(0,i.useState)(!1);(0,i.useEffect)((()=>{v&&(async()=>{if(v){const e=new(p()),t=await e.loadAsync(v),a=[];t.forEach((async(e,t)=>{const i=await t.async("blob");a.push(new File([i],e,{type:"image/jpeg"}))})),u(a),console.log("unzipping files in useeffect")}})()}),[v,u]);return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(d.Z,{title:"Job Card Vehicle Details",children:(0,x.jsxs)(n.ZP,{container:!0,direction:"row",spacing:m.dv,children:[(0,x.jsx)(n.ZP,{item:!0,xs:4,children:(0,x.jsx)(o.Z,{label:"Vehicle Reg. No.",required:!0,variant:"outlined",value:t.vehicleRegNo||"",onChange:e=>{const i={...t,vehicleRegNo:e.target.value.toUpperCase()};a(i)}})}),(0,x.jsx)(n.ZP,{item:!0,xs:4,children:(0,x.jsx)(o.Z,{label:"Vehicle Name",required:!0,variant:"outlined",value:t.vehicleName||"",onChange:e=>{const i={...t,vehicleName:e.target.value};a(i)}})}),(0,x.jsx)(n.ZP,{item:!0,xs:4,children:(0,x.jsx)(o.Z,{label:"Vehicle K.Ms",variant:"outlined",value:t.kiloMeters||"",onChange:e=>{const i={...t,kiloMeters:e.target.value};a(i)}})}),(0,x.jsx)(n.ZP,{item:!0,xs:12,children:(0,x.jsx)(r.Z,{variant:"h6",children:"Take Photos"})}),(0,x.jsx)(n.ZP,{item:!0,xs:12,children:j?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("video",{id:"camera-preview",autoPlay:!0,playsInline:!0,style:{width:"100%",height:"auto",border:"1px solid #ccc"},ref:e=>{e&&f&&(e.srcObject=f)}}),(0,x.jsx)(l.Z,{variant:"contained",color:"secondary",onClick:async()=>{if(!f)return;const e=document.querySelector("#camera-preview"),t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;t.getContext("2d").drawImage(e,0,0,t.width,t.height);const a=await new Promise((e=>t.toBlob(e,"image/jpeg")));u((e=>[...e,new File([a],`photo_${e.length+1}.jpg`,{type:"image/jpeg"})]))},style:{margin:"10px"},children:"Capture Photo"}),(0,x.jsx)(l.Z,{variant:"outlined",onClick:()=>{f&&(f.getTracks().forEach((e=>e.stop())),w(null)),Z(!1)},children:"Stop Camera"})]}):(0,x.jsxs)(n.ZP,{container:!0,direction:"row",spacing:m.dv,children:[(0,x.jsx)(n.ZP,{item:!0,xs:6,children:(0,x.jsx)(l.Z,{variant:"contained",color:"primary",onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});w(e),Z(!0)}catch(e){console.error("Error accessing the camera:",e),alert("Unable to access the camera.")}},children:"Start Camera"})}),(0,x.jsx)(n.ZP,{item:!0,xs:6,children:(0,x.jsx)(l.Z,{variant:"contained",color:"primary",onClick:()=>{y(!0),console.log(b)},children:"Load photos"})})]})}),(0,x.jsx)(n.ZP,{item:!0,xs:12,children:g.length>0&&(0,x.jsxs)(c.Z,{children:[(0,x.jsxs)(r.Z,{variant:"body1",children:[g.length," photo(s) captured."]}),(0,x.jsx)(n.ZP,{container:!0,spacing:2,children:g.map(((e,t)=>(0,x.jsxs)(n.ZP,{item:!0,xs:12,sm:6,md:4,style:{textAlign:"center"},children:[(0,x.jsx)("img",{src:URL.createObjectURL(e),alt:`Captured ${t+1}`,style:{width:"100%",height:"auto",maxHeight:"200px",objectFit:"contain",border:"1px solid #ccc",marginBottom:"10px"}}),(0,x.jsx)(s.Z,{color:"error",onClick:()=>(e=>{u((t=>t.filter(((t,a)=>a!==e))))})(t),"aria-label":"delete photo",children:(0,x.jsx)(h.Z,{})})]},t)))})]})}),(0,x.jsx)(n.ZP,{item:!0,xs:6,children:(0,x.jsx)(l.Z,{variant:"contained",color:"primary",onClick:()=>{0!==g.length?(g.forEach(((e,t)=>{console.log(t);const a=document.createElement("a");a.href=URL.createObjectURL(e),a.download=e.name,a.click(),URL.revokeObjectURL(a.href)})),alert(`${g.length} photo(s) saved locally.`)):alert("No photos to save.")},disabled:0===g.length,children:"Save Photos Locally"})}),(0,x.jsx)(n.ZP,{item:!0,xs:6,children:(0,x.jsx)(l.Z,{variant:"contained",color:"primary",onClick:()=>{var e,a;const i=null===(e=t.ownerPhoneNumber)||void 0===e?void 0:e.trim(),n=null===(a=t.vehicleRegNo)||void 0===a?void 0:a.trim();if(!i)return void alert("Please fill in the Owner Phone number.");if(!n)return void alert("Please fill in the Vehicle Registration Number.");const o=`https://api.whatsapp.com/send?phone=91${i}&text=${encodeURIComponent(`Greetings from CarSquare. Please find attached your car ${n} images`)}`;window.open(o,"_blank")},disabled:0===g.length,children:"Send via WhatsApp"})})]})})})}},27247:function(e,t,a){var i=a(64836);t.Z=void 0;var n=i(a(45649)),o=a(80184),r=(0,n.default)((0,o.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.Z=r}}]);
//# sourceMappingURL=42.673f764a.chunk.js.map