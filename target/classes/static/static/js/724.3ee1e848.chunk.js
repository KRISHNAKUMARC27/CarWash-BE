"use strict";(self.webpackChunkcar_wash_management=self.webpackChunkcar_wash_management||[]).push([[724],{50724:function(e,s,a){a.r(s);var t=a(72791),d=a(61889),l=a(39281),n=a(79836),i=a(56890),r=a(35855),o=a(53994),c=a(53382),u=a(68096),h=a(94925),x=a(58406),p=a(23786),v=a(49644),j=a(48550),m=a(94294),Z=a(13967),g=a(95193),y=a(23735),I=a(19035),w=a(80184);s.default=e=>{let{data:s,updateData:a}=e;const b=(0,Z.Z)(),f=(0,g.Z)(b.breakpoints.down("sm")),[A,C]=t.useState([]),[D,S]=t.useState([]),[k,E]=t.useState([]),W=["ADMIN"],q=(JSON.parse(localStorage.getItem("roles"))||[]).some((e=>W.includes(e)));t.useEffect((()=>(L(),_(),()=>{C([]),S([]),E([])})),[]);const L=async()=>{try{const e=await(0,I.A_)("/spares/sparesCategory");C(e)}catch(e){console.log(e.message)}},_=async()=>{try{const e=await(0,I.A_)("/spares");E(e)}catch(e){console.log(e.message)}},N=(e,t,d)=>{const l=[...s],n=l.findIndex((s=>s.sparesId===e));l[n][t]=d,"ADD"!==l[n].action&&(l[n].action="MODIFY"),a(l)},O=e=>{(async e=>{try{const s=await(0,I.j0)("/spares/findSparesInventoryWithFilter",e);S(s)}catch(s){console.log(s.message)}})({categoryList:[e]})};return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(y.Z,{title:"Job Spares Information",children:[(0,w.jsx)("div",{style:{overflowX:"auto"},children:(0,w.jsx)(l.Z,{children:(0,w.jsxs)(n.Z,{style:{minWidth:f?"600px":"1000px"},children:[(0,w.jsx)(i.Z,{children:(0,w.jsxs)(r.Z,{children:[(0,w.jsx)(o.Z,{sx:{width:"20%"},children:"Category"}),(0,w.jsx)(o.Z,{sx:{width:"30%"},children:"Spares"}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:"Qty"}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:"Rate"}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:"Discount"}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:"Amount"}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:"Action"})]})}),(0,w.jsx)(c.Z,{children:s.filter((e=>"DELETE"!==e.action)).map((e=>(0,w.jsxs)(r.Z,{children:[(0,w.jsx)(o.Z,{sx:{width:"20%"},children:(0,w.jsxs)(u.Z,{variant:"standard",sx:{m:1,minWidth:120},children:[(0,w.jsx)(h.Z,{id:"demo-simple-select-standard-label"}),(0,w.jsx)(x.Z,{fullWidth:!0,labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard-label",value:(null===e||void 0===e?void 0:e.category)||"",label:"Category Type",sx:{"& .MuiSelect-select":{color:"black"}},onChange:s=>{O(s.target.value),N(e.sparesId,"category",s.target.value)},children:A.map((e=>(0,w.jsx)(p.Z,{value:e.category,children:e.category},e.id)))})]})}),(0,w.jsx)(o.Z,{sx:{width:"30%"},children:(0,w.jsx)(v.Z,{options:D.filter((e=>!s.some((s=>s.sparesId===e.id)))),getOptionLabel:e=>e.desc,style:{width:300},value:k.find((s=>s.desc===e.sparesAndLabour))||null,isOptionEqualToValue:(e,s)=>e.id===s.id,onChange:(s,a)=>{N(e.sparesId,"sparesAndLabour",a.desc),N(e.sparesId,"rate",a.sellRate),N(e.sparesId,"amount",a.sellRate*(null===e||void 0===e?void 0:e.qty)-(null===e||void 0===e?void 0:e.discount)||0),N(e.sparesId,"sparesId",a.id)},renderInput:s=>(0,w.jsx)(j.Z,{...s,label:"Search Spares",disabled:!!e.sparesId})})}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.qty)||"",onChange:s=>{const a=s.target.value;N(e.sparesId,"qty",a),N(e.sparesId,"amount",a*(null===e||void 0===e?void 0:e.rate)-(null===e||void 0===e?void 0:e.discount)||0)},onBlur:s=>{const a=s.target.value;Number(a)<=0&&(alert("Quantity cannot be 0. Please delete the row if you want to remove the spare."),N(e.sparesId,"qty",""))}})}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{fullWidth:!0,disabled:!0,value:(null===e||void 0===e?void 0:e.rate)||"",onChange:s=>N(e.sparesId,"rate",s.target.value)})}),q&&(0,w.jsx)(o.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.discount)||"",onChange:s=>{const a=Number(s.target.value)||0;N(e.sparesId,"discount",a),N(e.sparesId,"amount",Number((null===e||void 0===e?void 0:e.rate)*(null===e||void 0===e?void 0:e.qty))-a||0)}})}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.amount)||"",disabled:!0,onChange:s=>N(e.sparesId,"amount",s.target.value)})}),(0,w.jsx)(o.Z,{sx:{width:"10%"},children:(0,w.jsx)(m.Z,{variant:"contained",color:"error",onClick:()=>(e=>{const t=[...s],d=t.findIndex((s=>s.sparesId===e));"ADD"===t[d].action?t.splice(d,1):t[d].action="DELETE",a(t)})(e.sparesId),children:"Delete"})})]},e.sparesId||e.tempId)))})]})})}),(0,w.jsxs)(d.ZP,{item:!0,xs:12,children:[(0,w.jsx)("br",{}),(0,w.jsx)(m.Z,{variant:"contained",color:"error",onClick:()=>{const e=[...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",discount:"",amount:"",action:"ADD"})));a((s=>[...null!==s&&void 0!==s?s:[],...e]))},children:"Add Row"})]})]})})}}}]);
//# sourceMappingURL=724.3ee1e848.chunk.js.map