"use strict";(self.webpackChunkcar_wash_management=self.webpackChunkcar_wash_management||[]).push([[8143,724,2789],{58143:function(e,t,s){s.r(t);var n=s(72791),a=s(61889),r=s(48550),i=s(94294),o=s(23735),l=s(91923),d=s(32789),c=s(50724),u=s(29464),h=s(19035),v=s(80184);t.default=()=>{const[e,t]=(0,n.useState)({}),[s,x]=(0,n.useState)([]),[p,j]=(0,n.useState)([]),[Z,m]=(0,n.useState)(!1),[f,g]=(0,n.useState)(""),[y,w]=(0,n.useState)(""),b=(0,n.useRef)(),I=(0,n.useRef)(),C=(0,n.useRef)(),S=(0,n.useRef)(),D=(0,n.useRef)(),N=(0,n.useRef)(),R=(0,n.useRef)(),A=(s,n)=>{t({...e,[s]:n})},q=(e,t)=>{var s;"Enter"===e.key&&(e.preventDefault(),null===t||void 0===t||null===(s=t.current)||void 0===s||s.focus())},k=()=>{t({}),j([]),x([])},P=e=>e.some((e=>{let{sparesId:t,category:s,sparesAndLabour:n,qty:a,rate:r,amount:i}=e;return!t||!s||!n||!a||!r||!i}));return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(o.Z,{title:"Job Card Details",children:(0,v.jsxs)(a.ZP,{container:!0,direction:"row",spacing:l.dv,children:[(0,v.jsx)(a.ZP,{item:!0,xs:3,children:(0,v.jsx)(r.Z,{inputRef:b,label:"Owner Name",required:!0,variant:"outlined",value:e.ownerName||"",onChange:e=>A("ownerName",e.target.value),onKeyDown:e=>q(e,I)})}),(0,v.jsx)(a.ZP,{item:!0,xs:3,children:(0,v.jsx)(r.Z,{inputRef:I,label:"Owner PhoneNumber",required:!0,variant:"outlined",value:e.ownerPhoneNumber||"",onChange:e=>A("ownerPhoneNumber",e.target.value),onKeyDown:e=>q(e,C)})}),(0,v.jsx)(a.ZP,{item:!0,xs:6,children:(0,v.jsx)(r.Z,{inputRef:C,label:"Owner Address",fullWidth:!0,variant:"outlined",value:e.ownerAddress||"",onChange:e=>A("ownerAddress",e.target.value),onKeyDown:e=>q(e,S)})}),(0,v.jsx)(a.ZP,{item:!0,xs:3,children:(0,v.jsx)(r.Z,{inputRef:S,label:"Vehicle Reg. No.",required:!0,variant:"outlined",value:e.vehicleRegNo||"",onChange:e=>A("vehicleRegNo",e.target.value),onKeyDown:e=>q(e,D)})}),(0,v.jsx)(a.ZP,{item:!0,xs:3,children:(0,v.jsx)(r.Z,{inputRef:D,label:"Vehicle Name",required:!0,variant:"outlined",value:e.vehicleName||"",onChange:e=>A("vehicleName",e.target.value),onKeyDown:e=>q(e,N)})}),(0,v.jsx)(a.ZP,{item:!0,xs:3,children:(0,v.jsx)(r.Z,{inputRef:N,label:"Vehicle K.Ms",variant:"outlined",value:e.kiloMeters||"",onChange:e=>A("kiloMeters",e.target.value),onKeyDown:e=>q(e,R)})}),(0,v.jsx)(a.ZP,{item:!0,xs:12,children:(0,v.jsx)(d.default,{data:s,updateData:x,firstInputRef:R})}),(0,v.jsx)(a.ZP,{item:!0,xs:12,children:(0,v.jsx)(c.default,{data:p,updateData:j})}),e.ownerName&&e.ownerPhoneNumber&&e.vehicleRegNo&&e.vehicleName&&(0,v.jsx)(a.ZP,{item:!0,xs:12,children:(0,v.jsx)(i.Z,{variant:"contained",color:"error",onClick:async()=>{if(P(s)||P(p))return void alert("Please fill all required fields in Service or Spares");const t={...e,jobServiceInfo:s,jobSparesInfo:p};try{await(0,h.j0)("/jobCard/fastjobCard",t),k(),g("Jobcard created for "+t.vehicleRegNo),w("success"),m(!0)}catch(n){console.log(n.message),k(),g(n.message),w("info"),m(!0)}},children:"Save JobCard"})})]})}),Z&&(0,v.jsx)(u.Z,{showAlert:Z,setShowAlert:m,alertColor:y,alertMess:f})]})}},32789:function(e,t,s){s.r(t);var n=s(72791),a=s(39281),r=s(79836),i=s(56890),o=s(35855),l=s(53994),d=s(53382),c=s(68096),u=s(94925),h=s(58406),v=s(23786),x=s(49644),p=s(48550),j=s(94294),Z=s(61889),m=s(23735),f=s(13967),g=s(95193),y=s(19035),w=s(80184);t.default=e=>{let{data:t,updateData:s,firstInputRef:b}=e;const I=(0,f.Z)(),C=(0,g.Z)(I.breakpoints.down("sm")),S=["ADMIN"],D=(JSON.parse(localStorage.getItem("roles"))||[]).some((e=>S.includes(e))),[N,R]=n.useState([]),[A,q]=n.useState([]),[k,P]=n.useState([]);n.useEffect((()=>(W(),E(),()=>{R([]),q([]),P([])})),[]);const W=async()=>{try{const e=await(0,y.A_)("/service/serviceCategory");R(e)}catch(e){console.log(e.message)}},E=async()=>{try{const e=await(0,y.A_)("/service");P(e)}catch(e){console.log(e.message)}},L=(e,n,a)=>{const r=[...t];r[e][n]=a,s(r)},M=e=>{(async e=>{try{const t=await(0,y.j0)("/service/findServiceInventoryWithFilter",e);q(t)}catch(t){console.log(t.message)}})({categoryList:[e]})};return(0,w.jsxs)(m.Z,{title:"Job Service Information",children:[(0,w.jsx)("div",{style:{overflowX:"auto"},children:(0,w.jsx)(a.Z,{children:(0,w.jsxs)(r.Z,{style:{minWidth:C?"600px":"1000px"},children:[(0,w.jsx)(i.Z,{children:(0,w.jsxs)(o.Z,{children:[(0,w.jsx)(l.Z,{sx:{width:"20%"},children:"Category"}),(0,w.jsx)(l.Z,{sx:{width:"30%"},children:"Service"}),(0,w.jsx)(l.Z,{sx:{width:"10%"},children:"Qty"}),(0,w.jsx)(l.Z,{sx:{width:"10%"},children:"Rate"}),D&&(0,w.jsx)(l.Z,{sx:{width:"10%"},children:"Discount"}),(0,w.jsx)(l.Z,{sx:{width:"10%"},children:"Amount"}),(0,w.jsx)(l.Z,{sx:{width:"10%"},children:"Action"})]})}),(0,w.jsx)(d.Z,{children:null===t||void 0===t?void 0:t.map(((e,n)=>(0,w.jsxs)(o.Z,{children:[(0,w.jsx)(l.Z,{sx:{width:"20%"},children:(0,w.jsxs)(c.Z,{variant:"standard",sx:{m:1,minWidth:120},children:[(0,w.jsx)(u.Z,{}),(0,w.jsx)(h.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.category)||"",onChange:e=>{M(e.target.value),L(n,"category",e.target.value)},onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),null===(t=document.querySelector(`#spares-input-${n}`))||void 0===t||t.focus())},children:N.map((e=>(0,w.jsx)(v.Z,{value:e.category,children:e.category},e.id)))})]})}),(0,w.jsx)(l.Z,{sx:{width:"30%"},children:(0,w.jsx)(x.Z,{options:A.filter((e=>!t.some((t=>t.sparesId===e.id)))),getOptionLabel:e=>e.desc,style:{width:300},value:k.find((t=>t.desc===e.sparesAndLabour))||null,isOptionEqualToValue:(e,t)=>e.id===t.id,onChange:(t,s)=>{s&&(L(n,"sparesAndLabour",s.desc),L(n,"rate",s.amount),L(n,"amount",s.amount*(null===e||void 0===e?void 0:e.qty)-(null===e||void 0===e?void 0:e.discount)||0),L(n,"sparesId",s.id))},renderInput:t=>(0,w.jsx)(p.Z,{...t,id:`spares-input-${n}`,label:"Search Service",disabled:!!e.sparesId,onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),null===(t=document.querySelector(`#qty-input-${n}`))||void 0===t||t.focus())}})})}),(0,w.jsx)(l.Z,{sx:{width:"10%"},children:(0,w.jsx)(p.Z,{fullWidth:!0,id:`qty-input-${n}`,value:(null===e||void 0===e?void 0:e.qty)||"",onChange:t=>{const s=t.target.value;L(n,"qty",s),L(n,"amount",s*(null===e||void 0===e?void 0:e.rate)-(null===e||void 0===e?void 0:e.discount)||0)},onKeyDown:e=>{var t,s;"Enter"===e.key&&(e.preventDefault(),D?null===(t=document.querySelector(`#discount-input-${n}`))||void 0===t||t.focus():null===b||void 0===b||null===(s=b.current)||void 0===s||s.focus())}})}),(0,w.jsx)(l.Z,{sx:{width:"10%"},children:(0,w.jsx)(p.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.rate)||"",disabled:!0})}),D&&(0,w.jsx)(l.Z,{sx:{width:"10%"},children:(0,w.jsx)(p.Z,{fullWidth:!0,id:`discount-input-${n}`,value:(null===e||void 0===e?void 0:e.discount)||"",onChange:t=>{const s=Number(t.target.value)||0;L(n,"discount",s),L(n,"amount",Number((null===e||void 0===e?void 0:e.rate)*(null===e||void 0===e?void 0:e.qty))-s||0)},onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),null===b||void 0===b||null===(t=b.current)||void 0===t||t.focus())}})}),(0,w.jsx)(l.Z,{sx:{width:"10%"},children:(0,w.jsx)(p.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.amount)||"",disabled:!0})}),(0,w.jsx)(l.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{variant:"contained",color:"error",onClick:()=>(e=>{const n=[...t];n.splice(e,1),n.length>0?s(n):s(null)})(n),children:"Delete"})})]},n)))})]})})}),(0,w.jsxs)(Z.ZP,{item:!0,xs:12,children:[(0,w.jsx)("br",{}),(0,w.jsx)(j.Z,{variant:"contained",color:"error",onClick:()=>{const e=[{sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",discount:"",amount:""}];s((t=>[...null!==t&&void 0!==t?t:[],...e]))},ref:b,children:"Add Row"})]})]})}},50724:function(e,t,s){s.r(t);var n=s(72791),a=s(61889),r=s(39281),i=s(79836),o=s(56890),l=s(35855),d=s(53994),c=s(53382),u=s(68096),h=s(94925),v=s(58406),x=s(23786),p=s(49644),j=s(48550),Z=s(94294),m=s(13967),f=s(95193),g=s(23735),y=s(19035),w=s(80184);t.default=e=>{let{data:t,updateData:s}=e;const b=(0,m.Z)(),I=(0,f.Z)(b.breakpoints.down("sm")),[C,S]=n.useState([]),[D,N]=n.useState([]),[R,A]=n.useState([]),q=["ADMIN"],k=(JSON.parse(localStorage.getItem("roles"))||[]).some((e=>q.includes(e)));n.useEffect((()=>(P(),W(),()=>{S([]),N([]),A([])})),[]);const P=async()=>{try{const e=await(0,y.A_)("/spares/sparesCategory");S(e)}catch(e){console.log(e.message)}},W=async()=>{try{const e=await(0,y.A_)("/spares");A(e)}catch(e){console.log(e.message)}},E=(e,n,a)=>{const r=[...t],i=r.findIndex((t=>t.sparesId===e));r[i][n]=a,"ADD"!==r[i].action&&(r[i].action="MODIFY"),s(r)},L=e=>{(async e=>{try{const t=await(0,y.j0)("/spares/findSparesInventoryWithFilter",e);N(t)}catch(t){console.log(t.message)}})({categoryList:[e]})};return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(g.Z,{title:"Job Spares Information",children:[(0,w.jsx)("div",{style:{overflowX:"auto"},children:(0,w.jsx)(r.Z,{children:(0,w.jsxs)(i.Z,{style:{minWidth:I?"600px":"1000px"},children:[(0,w.jsx)(o.Z,{children:(0,w.jsxs)(l.Z,{children:[(0,w.jsx)(d.Z,{sx:{width:"20%"},children:"Category"}),(0,w.jsx)(d.Z,{sx:{width:"30%"},children:"Spares"}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:"Qty"}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:"Rate"}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:"Discount"}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:"Amount"}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:"Action"})]})}),(0,w.jsx)(c.Z,{children:t.filter((e=>"DELETE"!==e.action)).map((e=>(0,w.jsxs)(l.Z,{children:[(0,w.jsx)(d.Z,{sx:{width:"20%"},children:(0,w.jsxs)(u.Z,{variant:"standard",sx:{m:1,minWidth:120},children:[(0,w.jsx)(h.Z,{id:"demo-simple-select-standard-label"}),(0,w.jsx)(v.Z,{fullWidth:!0,labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard-label",value:(null===e||void 0===e?void 0:e.category)||"",label:"Category Type",sx:{"& .MuiSelect-select":{color:"black"}},onChange:t=>{L(t.target.value),E(e.sparesId,"category",t.target.value)},children:C.map((e=>(0,w.jsx)(x.Z,{value:e.category,children:e.category},e.id)))})]})}),(0,w.jsx)(d.Z,{sx:{width:"30%"},children:(0,w.jsx)(p.Z,{options:D.filter((e=>!t.some((t=>t.sparesId===e.id)))),getOptionLabel:e=>e.desc,style:{width:300},value:R.find((t=>t.desc===e.sparesAndLabour))||null,isOptionEqualToValue:(e,t)=>e.id===t.id,onChange:(t,s)=>{E(e.sparesId,"sparesAndLabour",s.desc),E(e.sparesId,"rate",s.sellRate),E(e.sparesId,"amount",s.sellRate*(null===e||void 0===e?void 0:e.qty)-(null===e||void 0===e?void 0:e.discount)||0),E(e.sparesId,"sparesId",s.id)},renderInput:t=>(0,w.jsx)(j.Z,{...t,label:"Search Spares",disabled:!!e.sparesId})})}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.qty)||"",onChange:t=>{const s=t.target.value;E(e.sparesId,"qty",s),E(e.sparesId,"amount",s*(null===e||void 0===e?void 0:e.rate)-(null===e||void 0===e?void 0:e.discount)||0)},onBlur:t=>{const s=t.target.value;Number(s)<=0&&(alert("Quantity cannot be 0. Please delete the row if you want to remove the spare."),E(e.sparesId,"qty",""))}})}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{fullWidth:!0,disabled:!0,value:(null===e||void 0===e?void 0:e.rate)||"",onChange:t=>E(e.sparesId,"rate",t.target.value)})}),k&&(0,w.jsx)(d.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.discount)||"",onChange:t=>{const s=Number(t.target.value)||0;E(e.sparesId,"discount",s),E(e.sparesId,"amount",Number((null===e||void 0===e?void 0:e.rate)*(null===e||void 0===e?void 0:e.qty))-s||0)}})}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:(0,w.jsx)(j.Z,{fullWidth:!0,value:(null===e||void 0===e?void 0:e.amount)||"",disabled:!0,onChange:t=>E(e.sparesId,"amount",t.target.value)})}),(0,w.jsx)(d.Z,{sx:{width:"10%"},children:(0,w.jsx)(Z.Z,{variant:"contained",color:"error",onClick:()=>(e=>{const n=[...t],a=n.findIndex((t=>t.sparesId===e));"ADD"===n[a].action?n.splice(a,1):n[a].action="DELETE",s(n)})(e.sparesId),children:"Delete"})})]},e.sparesId||e.tempId)))})]})})}),(0,w.jsxs)(a.ZP,{item:!0,xs:12,children:[(0,w.jsx)("br",{}),(0,w.jsx)(Z.Z,{variant:"contained",color:"error",onClick:()=>{const e=[...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",discount:"",amount:"",action:"ADD"})));s((t=>[...null!==t&&void 0!==t?t:[],...e]))},children:"Add Row"})]})]})})}},39281:function(e,t,s){s.d(t,{Z:function(){return j}});var n=s(87462),a=s(63366),r=s(72791),i=s(63733),o=s(94419),l=s(31402),d=s(66934),c=s(75878),u=s(21217);function h(e){return(0,u.Z)("MuiTableContainer",e)}(0,c.Z)("MuiTableContainer",["root"]);var v=s(80184);const x=["className","component"],p=(0,d.ZP)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,t)=>t.root})({width:"100%",overflowX:"auto"});var j=r.forwardRef((function(e,t){const s=(0,l.Z)({props:e,name:"MuiTableContainer"}),{className:r,component:d="div"}=s,c=(0,a.Z)(s,x),u=(0,n.Z)({},s,{component:d}),j=(e=>{const{classes:t}=e;return(0,o.Z)({root:["root"]},h,t)})(u);return(0,v.jsx)(p,(0,n.Z)({ref:t,as:d,className:(0,i.Z)(j.root,r),ownerState:u},c))}))}}]);
//# sourceMappingURL=8143.f5339aa5.chunk.js.map