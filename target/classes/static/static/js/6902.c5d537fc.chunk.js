"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[6902],{6902:function(e,t,r){r.r(t);var n=r(72791),o=r(68899),a=r(13967),s=r(61979),l=r(44507),i=r(64554),c=r(20068),d=r(13400),u=r(38820),h=r(17100),p=r(45781),f=r(93213),m=r(24657),y=r(44713),g=r(19035),v=r(29464),w=r(80184);const x=(0,y.Z)((0,n.lazy)((()=>r.e(7901).then(r.bind(r,22298))))),b=(0,y.Z)((0,n.lazy)((()=>r.e(2909).then(r.bind(r,72909))))),S=(0,y.Z)((0,n.lazy)((()=>r.e(9158).then(r.bind(r,49158))))),j=(0,m.iL)({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0});t.default=()=>{const[e,t]=(0,n.useState)(!1),[r,y]=(0,n.useState)(""),[C,z]=(0,n.useState)("info"),[Z,L]=(0,n.useState)([]),[M,A]=(0,n.useState)(),[R,O]=(0,n.useState)(!1),[k,E]=(0,n.useState)({}),H=(0,n.useMemo)((()=>Object.keys(k).map((e=>Z[e]))),[k,Z]),[T,K]=(0,n.useState)(!1),[F,V]=(0,n.useState)([]),[D,N]=(0,n.useState)({}),[P,B]=(0,n.useState)(!1);(0,n.useEffect)((()=>(_(),q(),()=>{L([]),V([])})),[]);const _=async()=>{try{const e=await(0,g.A_)("/invoice");L(e)}catch(e){console.error(e.message)}},q=async()=>{try{const e=await(0,g.A_)("/config/paymentmodes");V(e)}catch(e){console.log(e.message)}},I=()=>{O(!1),A({}),K(!1),B(!1),_()},U=(0,n.useMemo)((()=>[{accessorKey:"invoiceId",header:"Id",size:50},{accessorKey:"jobId",header:"JobCard No.",size:50},{accessorKey:"grandTotal",header:"Bill Amt",size:50},{accessorKey:"pendingAmount",header:"Pending",size:50},{accessorKey:"ownerName",header:"Owner",size:50},{accessorKey:"vehicleName",header:"Vehicle",size:50},{accessorKey:"vehicleRegNo",header:"Reg. No.",size:50},{accessorKey:"ownerPhoneNumber",header:"Phone",size:100},{accessorKey:"billCloseDate",header:"Bill Close Date",size:100},{accessorKey:"creditFlag",header:"Credit ?",size:100,filterVariant:"multi-select",Cell:e=>{let{cell:t}=e;return t.getValue()?"Yes":"No"}},{accessorKey:"creditSettledFlag",header:"Credit Settled ?",size:100,filterVariant:"multi-select",Cell:e=>{let{cell:t}=e;return t.getValue()?"Yes":"No"}}]),[]),W=(0,a.Z)(),$=(0,n.useMemo)((()=>(0,s.Z)({palette:{mode:W.palette.mode,primary:W.palette.secondary,info:{main:"rgb(255,122,0)"},background:{default:"rgba(0, 0, 0, 0)"}},typography:{button:{textTransform:"none",fontSize:"1.2rem"}},components:{MuiTooltip:{styleOverrides:{tooltip:{fontSize:"1.1rem"}}},MuiSwitch:{styleOverrides:{thumb:{color:"pink"}}}}})),[W]);return(0,w.jsxs)(w.Fragment,{children:[e&&(0,w.jsx)(v.Z,{showAlert:e,setShowAlert:t,alertColor:C,alertMess:r}),(0,w.jsx)(l.Z,{theme:$,children:(0,w.jsx)(o.P2,{columns:U,data:Z,enableFacetedValues:!0,enableEditing:!0,enableRowSelection:!0,onRowSelectionChange:E,state:{rowSelection:k},muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:"linear-gradient(195deg, #e2d7d5, #cf8989)"}},renderRowActions:e=>{let{row:t}=e;return(0,w.jsx)(i.Z,{sx:{display:"flex",gap:"1rem"},children:(0,w.jsx)(c.Z,{arrow:!0,placement:"right",title:"Invoice",children:(0,w.jsx)(d.Z,{onClick:()=>{A(t.original),O(!0)},children:(0,w.jsx)(u.Z,{})})})})},renderTopToolbarCustomActions:e=>{let{table:t}=e;const r=t.getSelectedRowModel().flatRows.map((e=>e.original)),n=t.getState().rowSelection;return(0,w.jsxs)(i.Z,{sx:{display:"flex",gap:"1rem",p:"0.5rem",flexWrap:"wrap"},children:[(0,w.jsx)(c.Z,{title:"Export Data",children:(0,w.jsx)("span",{children:(0,w.jsx)(d.Z,{onClick:()=>(e=>{const t=e.map((e=>{const t=e.original,r={};for(const n in t){const e=t[n];r[n]="object"===typeof e&&null!==e?JSON.stringify(e):e}return r})),r=(0,m.gB)(j)(t);(0,m.LR)(j)(r)})(t.getPrePaginationRowModel().rows),disabled:0===t.getPrePaginationRowModel().rows.length,children:(0,w.jsx)(h.Z,{})})})}),Object.keys(n).length>0&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.Z,{title:"Settle Bill",children:(0,w.jsx)(d.Z,{onClick:()=>{r.some((e=>0===e.pendingAmount))?alert("One or more rows have a pending amount of 0."):K(!0)},children:(0,w.jsx)(p.Z,{})})}),(0,w.jsx)(c.Z,{title:"Receipt",children:(0,w.jsx)(d.Z,{onClick:()=>{N((e=>{var t,n;return{...e,amount:r.reduce(((e,t)=>e+(t.grandTotal||0)),0),invoiceIdList:r.map((e=>e.invoiceId)),ownerName:null!==(t=null===(n=r[0])||void 0===n?void 0:n.ownerName)&&void 0!==t?t:""}})),B(!0)},children:(0,w.jsx)(f.Z,{})})})]})]})}})}),R&&(0,w.jsx)(x,{invoice:M,setInvoice:A,paymentModes:F,invoiceCreateOpen:R,handleClose:I,setAlertMess:y,setShowAlert:t,setAlertColor:z}),T&&(0,w.jsx)(b,{paymentModes:F,settleBillDialogOpen:T,selectedRows:H,handleClose:I,setAlertMess:y,setShowAlert:t}),P&&(0,w.jsx)(S,{receipt:D,setReceipt:N,paymentModes:F,receiptDialogOpen:P,selectedRows:H,handleClose:I,setAlertMess:y,setShowAlert:t})]})}},38820:function(e,t,r){var n=r(76189),o=r(80184);t.Z=(0,n.Z)((0,o.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")},45781:function(e,t,r){var n=r(76189),o=r(80184);t.Z=(0,n.Z)((0,o.jsx)("path",{fillRule:"evenodd",d:"M20 3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM10 17H5v-2h5v2zm0-4H5v-2h5v2zm0-4H5V7h5v2zm4.82 6L12 12.16l1.41-1.41 1.41 1.42L17.99 9l1.42 1.42L14.82 15z"}),"FactCheck")},17100:function(e,t,r){var n=r(76189),o=r(80184);t.Z=(0,n.Z)((0,o.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"FileDownload")},93213:function(e,t,r){var n=r(76189),o=r(80184);t.Z=(0,n.Z)((0,o.jsx)("path",{d:"M18 17H6v-2h12v2zm0-4H6v-2h12v2zm0-4H6V7h12v2zM3 22l1.5-1.5L6 22l1.5-1.5L9 22l1.5-1.5L12 22l1.5-1.5L15 22l1.5-1.5L18 22l1.5-1.5L21 22V2l-1.5 1.5L18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2 4.5 3.5 3 2v20z"}),"Receipt")},24657:function(e,t,r){var n,o;r.d(t,{LR:function(){return Z},gB:function(){return z},iL:function(){return h}}),(o=n||(n={})).csv="text/csv",o.tsv="text/tab-separated-values",o.plain="text/plain";var a=e=>e,s=a,l=a,i=a,c=a,d=a,u={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,fileExtension:"csv",mediaType:n.csv,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},h=e=>Object.assign({},u,e);class p extends Error{constructor(e){super(e),this.name="CsvGenerationError"}}class f extends Error{constructor(e){super(e),this.name="EmptyHeadersError"}}class m extends Error{constructor(e){super(e),this.name="CsvDownloadEnvironmentError"}}class y extends Error{constructor(e){super(e),this.name="UnsupportedDataFormatError"}}var g=e=>c("object"===typeof e?e.key:e),v=e=>d("object"===typeof e?e.displayLabel:e),w=e=>t=>l(e+t+"\r\n"),x=e=>(t,r)=>b(e)(i(t+r)),b=e=>t=>t+e.fieldSeparator,S=(e,t)=>{if((e=>+e===e&&(!isFinite(e)||Boolean(e%1)))(t)){if("locale"===e.decimalSeparator)return s(t.toLocaleString());if(e.decimalSeparator)return s(t.toString().replace(".",e.decimalSeparator))}return s(t.toString())},j=(e,t)=>{let r=t;return(e.quoteStrings||e.fieldSeparator&&t.indexOf(e.fieldSeparator)>-1||e.quoteCharacter&&t.indexOf(e.quoteCharacter)>-1||t.indexOf("\n")>-1||t.indexOf("\r")>-1)&&(r=e.quoteCharacter+function(e,t){return'"'==t&&e.indexOf('"')>-1?e.replace(/"/g,'""'):e}(t,e.quoteCharacter)+e.quoteCharacter),s(r)},C=(e,t)=>{if("number"===typeof t)return S(e,t);if("string"===typeof t)return j(e,t);if("boolean"===typeof t&&e.boolDisplay)return((e,t)=>{const r=t?"true":"false";return s(e.boolDisplay[r])})(e,t);if(null===t||"undefined"===typeof t)return((e,t)=>"undefined"===typeof t&&void 0!==e.replaceUndefinedWith?j(e,e.replaceUndefinedWith+""):j(e,null===t?"null":""))(e,t);throw new y(`\n    typeof ${typeof t} isn't supported. Only number, string, boolean, null and undefined are supported.\n    Please convert the data in your object to one of those before generating the CSV.\n    `)},z=e=>t=>{const r=h(e),n=r.useKeysAsHeaders?Object.keys(t[0]):r.columnHeaders;let o=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce(((e,t)=>t(e)),e)}(l(""),(e=>t=>e.useBom?l(t+"\ufeff"):t)(r),(e=>t=>e.showTitle?w(l(t+e.title))(i("")):t)(r),((e,t)=>r=>{if(!e.showColumnHeaders)return r;if(t.length<1)throw new f("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let n=i("");for(let o=0;o<t.length;o++){const r=v(t[o]);n=x(e)(n,C(e,r))}return n=i(n.slice(0,-1)),w(r)(n)})(r,n),((e,t,r)=>n=>{let o=n;for(var a=0;a<r.length;a++){let n=i("");for(let o=0;o<t.length;o++){const s=g(t[o]),l=r[a][s];n=x(e)(n,C(e,l))}n=i(n.slice(0,-1)),o=w(o)(n)}return o})(r,n,t));if(o.length<1)throw new p("Output is empty. Is your data formatted correctly?");return o},Z=e=>t=>{if(!window)throw new m("Downloading only supported in a browser environment.");const r=(e=>t=>{const r=h(e),n=t,o=r.useTextFile?"text/plain":r.mediaType;return new Blob([n],{type:`${o};charset=utf8;`})})(e)(t),n=h(e),o=n.useTextFile?"txt":n.fileExtension,a=`${n.filename}.${o}`,s=document.createElement("a");s.download=a,s.href=URL.createObjectURL(r),s.setAttribute("visibility","hidden"),document.body.appendChild(s),s.click(),document.body.removeChild(s)}}}]);
//# sourceMappingURL=6902.c5d537fc.chunk.js.map