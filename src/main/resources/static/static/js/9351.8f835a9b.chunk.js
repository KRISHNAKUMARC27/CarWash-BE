"use strict";(self.webpackChunkcar_wash_management=self.webpackChunkcar_wash_management||[]).push([[9351],{79351:function(e,a,t){t.r(a),t.d(a,{default:function(){return I}});var r=t(72791),o=t(44713),s=t(68899),n=t(13967),l=t(61979),i=t(44507),c=t(20068),d=t(13400),h=t(5574),u=t(39157),p=t(61889),x=t(20890),j=t(94294),m=t(97123),b=t(48550),g=t(38820),Z=t(76189),y=t(80184),S=(0,Z.Z)((0,y.jsx)("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"}),"Build"),v=t(64554),P=t(91923),f=t(95587),C=t.n(f),w=t(19035),N=t(29464);const k=(0,o.Z)((0,r.lazy)((()=>t.e(8575).then(t.bind(t,88575))))),z=(0,o.Z)((0,r.lazy)((()=>t.e(42).then(t.bind(t,20042))))),V=(0,o.Z)((0,r.lazy)((()=>t.e(724).then(t.bind(t,50724))))),A=(0,o.Z)((0,r.lazy)((()=>t.e(2789).then(t.bind(t,32789)))));var I=()=>{const[e,a]=(0,r.useState)([]),[t,o]=(0,r.useState)({}),[Z,f]=(0,r.useState)({}),[I,E]=(0,r.useState)({}),[T,L]=(0,r.useState)([]),[O,J]=(0,r.useState)(),[M,U]=(0,r.useState)(!1),[D,q]=(0,r.useState)({}),[R,K]=(0,r.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",amount:"",discount:"",action:""})))),[_,W]=(0,r.useState)([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",amount:"0",discount:"0"})))),[F,G]=(0,r.useState)(!1),[B,H]=r.useState(!1),[Q,X]=r.useState(""),[Y,$]=r.useState("");(0,r.useEffect)((()=>(ee(),()=>{a([])})),[]);const ee=async()=>{try{const e=await(0,w.A_)("/jobCard/status/OPEN");a(e)}catch(e){console.error(e.message)}};const ae=async e=>{try{const t=await(0,w.GH)("/jobCard",e);if(0===T.length)return console.log("No photos to upload."),X("Job Card updated successfully. No photos to upload"),$("success"),H(!0),void se();const r=new(C());T.forEach(((e,a)=>{console.log(a),r.file(e.name,e)}));const o=await r.generateAsync({type:"blob"}),s=new FormData;s.append("file",new File([o],"photos.zip",{type:"application/zip"}));try{await(0,w.iV)("/jobCard/uploadPhotos/"+t.id,s),L([])}catch(a){console.log(a.message)}se()}catch(a){console.log(a.message),se(),X(a.message),H(!0)}},te=e=>{f(e),(async e=>{try{const a=await(0,w.A_)("/jobCard/jobSpares/"+e);E(a),K(a.jobSparesInfo),W(a.jobServiceInfo);let t={totalSparesValue:a.totalSparesValue,totalServiceValue:a.totalServiceValue,grandTotal:a.grandTotal};q(t),G(!0)}catch(a){console.error(a.message)}})(e.id)},re=e=>e.filter((e=>"DELETE"!==e.action)).reduce(((e,a)=>e+(Number(a.amount)||0)),0),oe=async e=>{try{await(0,w.j0)("/jobCard/jobSpares",e),se()}catch(a){console.log(a.message),se(),X(a.message),H(!0)}},se=()=>{ee(),L([]),U(!1),o({}),G(!1),f({}),K([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"",rate:"",discount:"",amount:""})))),W([...Array(1)].map((()=>({sparesId:"",category:"",sparesAndLabour:"",qty:"0",rate:"0",discount:"",amount:"0"})))),q({})},ne=(0,r.useMemo)((()=>[{accessorKey:"jobId",header:"Job Card No.",size:150},{accessorKey:"jobStatus",header:"Status",size:150,filterVariant:"select",filterSelectOptions:["OPEN","CLOSED","CANCELLED"]},{accessorKey:"ownerName",header:"Owner Name",size:150},{accessorKey:"ownerPhoneNumber",header:"Phone",size:200},{accessorKey:"vehicleRegNo",header:"Reg. No.",size:150},{accessorKey:"vehicleName",header:"Vehicle Name",size:150}]),[]),le=(0,n.Z)(),ie=(0,r.useMemo)((()=>(0,l.Z)({palette:{mode:le.palette.mode,primary:le.palette.secondary,info:{main:"rgb(255,122,0)"},background:{default:"rgba(0, 0, 0, 0)"}},typography:{button:{textTransform:"none",fontSize:"1.2rem"}},components:{MuiTooltip:{styleOverrides:{tooltip:{fontSize:"1.1rem"}}},MuiSwitch:{styleOverrides:{thumb:{color:"pink"}}}}})),[le]);function ce(){return(0,y.jsx)("hr",{style:{color:"#000000",backgroundColor:"#000000",height:1,borderColor:"#000000"}})}return(0,y.jsxs)("div",{children:[(0,y.jsxs)(i.Z,{theme:ie,children:[(0,y.jsx)(s.P2,{columns:ne,data:e,editingMode:"modal",enableEditing:!0,muiTablePaperProps:{elevation:0,sx:{borderRadius:"0",background:"linear-gradient(195deg, #d3d9ae, #f3f1e9)"}},renderRowActions:e=>{let{row:a}=e;return(0,y.jsxs)(v.Z,{sx:{display:"flex",gap:"1rem"},children:[(0,y.jsx)(c.Z,{arrow:!0,placement:"left",title:"Update Job Info",children:(0,y.jsx)(d.Z,{onClick:()=>{(async e=>{try{const a=await(0,w.iU)("/jobCard/getPhotos/"+e.id);console.log("Got zipblob"),J(a),o(e),U(!0)}catch(a){L([]),o(e),U(!0)}})(a.original)},children:(0,y.jsx)(g.Z,{})})}),(0,y.jsx)(c.Z,{arrow:!0,placement:"right",title:"Update Job Spares",children:(0,y.jsx)(d.Z,{onClick:()=>{te(a.original)},children:(0,y.jsx)(S,{})})})]})}})," "]}),(0,y.jsx)("br",{}),(0,y.jsxs)(h.Z,{open:M,onClose:se,"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"lg",children:[(0,y.jsxs)(u.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:[" ",(0,y.jsx)(p.ZP,{container:!0,spacing:P.dv,children:(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsxs)(p.ZP,{container:!0,spacing:P.dv,children:[(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(ce,{})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(x.Z,{variant:"h2",children:"Updating JobCard: "+t.jobId+" VehicleNo.: "+t.vehicleRegNo})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(z,{data:t,updateData:o,photos:T,updatePhotos:L,zipFile:O})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(k,{data:t,updateData:o})}),(0,y.jsx)(p.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:t.ownerName&&t.ownerAddress&&t.ownerPhoneNumber&&t.vehicleRegNo&&t.vehicleName&&t.kiloMeters&&(0,y.jsx)(j.Z,{variant:"contained",color:"error",onClick:()=>{ae(t)},children:"Update JobCard"})}),(0,y.jsx)(p.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(0,y.jsx)(j.Z,{variant:"contained",color:"error",onClick:se,children:"Cancel UpdateJobInfo"})})]})})})]}),(0,y.jsx)(m.Z,{children:(0,y.jsx)(j.Z,{onClick:se,children:"Close"})})]}),(0,y.jsx)("br",{}),(0,y.jsxs)(h.Z,{open:F,onClose:se,"aria-labelledby":"data-row-dialog-title",fullWidth:!0,maxWidth:"xl",children:[(0,y.jsxs)(u.Z,{dividers:!0,style:{backgroundColor:"white",color:"black"},children:[" ",(0,y.jsx)(p.ZP,{container:!0,spacing:P.dv,children:(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsxs)(p.ZP,{container:!0,spacing:P.dv,children:[(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(ce,{})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(x.Z,{variant:"h2",children:"Updating Spares for JobCard: "+Z.jobId+" VehicleNo.: "+Z.vehicleRegNo})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(A,{data:_,updateData:W})}),(0,y.jsx)(p.ZP,{item:!0,xs:12,children:(0,y.jsx)(V,{data:R,updateData:K})}),(0,y.jsx)(p.ZP,{item:!0,xs:3,children:(0,y.jsx)(b.Z,{label:"Total Service Value",required:!0,variant:"outlined",value:D.totalServiceValue||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(p.ZP,{item:!0,xs:3,children:(0,y.jsx)(b.Z,{label:"Total Spares Value",required:!0,variant:"outlined",value:D.totalSparesValue||"",InputProps:{readOnly:!0}})}),(0,y.jsx)(p.ZP,{item:!0,xs:4,children:(0,y.jsx)(b.Z,{label:"Grand Total",required:!0,variant:"outlined",value:D.grandTotal||"",InputProps:{readOnly:!0}})})]})})})]}),(0,y.jsx)(m.Z,{children:(0,y.jsxs)(p.ZP,{container:!0,spacing:P.dv,children:[(0,y.jsx)(p.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(R||_)&&(0,y.jsx)(j.Z,{variant:"contained",color:"error",onClick:()=>{const e=re(R);(e=>{const a={...D,totalSparesValue:e};q(a)})(e);const a=re(_);(e=>{const a={...D,totalServiceValue:e};q(a)})(a);const t=e+a;(e=>{const a={...D,grandTotal:e};q(a)})(t);const r={...I,jobSparesInfo:R,jobServiceInfo:_,totalSparesValue:e,totalServiceValue:a,grandTotal:t};oe(r)},children:"Update JobSpares"})}),(0,y.jsx)(p.ZP,{item:!0,lg:3,md:6,sm:6,xs:12,children:(0,y.jsx)(j.Z,{variant:"contained",color:"error",onClick:se,children:"Cancel Update Spares"})})]})})]}),B&&(0,y.jsx)(N.Z,{showAlert:B,setShowAlert:H,alertColor:Y,alertMess:Q})]})}},38820:function(e,a,t){var r=t(76189),o=t(80184);a.Z=(0,r.Z)((0,o.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")}}]);
//# sourceMappingURL=9351.8f835a9b.chunk.js.map