{"version":3,"file":"static/js/42.673f764a.chunk.js","mappings":"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","sources":["views/job/JobCarDetails.js","../node_modules/@mui/icons-material/Delete.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// material-ui\r\nimport { Grid, TextField, Button, Typography, Box, IconButton } from '@mui/material';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport MainCard from 'ui-component/cards/MainCard';\r\nimport { gridSpacing } from 'store/constant';\r\nimport JSZip from 'jszip';\r\n\r\nconst JobCarDetails = ({ data, updateData, photos, updatePhotos, zipFile }) => {\r\n  const [isCapturing, setIsCapturing] = useState(false);\r\n  const [stream, setStream] = useState(null);\r\n  const [loadPhotos, setLoadPhotos] = useState(false);\r\n  useEffect(() => {\r\n    const unzipPhotos = async () => {\r\n      if (zipFile) {\r\n        const jszip = new JSZip();\r\n        const zip = await jszip.loadAsync(zipFile);\r\n        const files = [];\r\n        zip.forEach(async (relativePath, file) => {\r\n          const fileBlob = await file.async('blob');\r\n          files.push(new File([fileBlob], relativePath, { type: 'image/jpeg' }));\r\n        });\r\n        updatePhotos(files); // Initialize photos with unzipped files\r\n        console.log('unzipping files in useeffect');\r\n      }\r\n    };\r\n\r\n    if (zipFile) {\r\n      unzipPhotos();\r\n    }\r\n  }, [zipFile, updatePhotos]);\r\n\r\n  const startCamera = async () => {\r\n    try {\r\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\r\n        video: { facingMode: 'environment' } // Rear camera\r\n      });\r\n      setStream(mediaStream);\r\n      setIsCapturing(true);\r\n    } catch (error) {\r\n      console.error('Error accessing the camera:', error);\r\n      alert('Unable to access the camera.');\r\n    }\r\n  };\r\n\r\n  const stopCamera = () => {\r\n    if (stream) {\r\n      stream.getTracks().forEach((track) => track.stop());\r\n      setStream(null);\r\n    }\r\n    setIsCapturing(false);\r\n  };\r\n\r\n  const capturePhoto = async () => {\r\n    if (!stream) {\r\n      return;\r\n    }\r\n    const videoElement = document.querySelector('#camera-preview');\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = videoElement.videoWidth;\r\n    canvas.height = videoElement.videoHeight;\r\n\r\n    const context = canvas.getContext('2d');\r\n    context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);\r\n\r\n    // Convert canvas to Blob and store in state\r\n    const photoBlob = await new Promise((resolve) => canvas.toBlob(resolve, 'image/jpeg'));\r\n\r\n    updatePhotos((prevPhotos) => [\r\n      ...prevPhotos,\r\n      new File([photoBlob], `photo_${prevPhotos.length + 1}.jpg`, {\r\n        type: 'image/jpeg'\r\n      })\r\n    ]);\r\n  };\r\n\r\n  const savePhotos = () => {\r\n    if (photos.length === 0) {\r\n      alert('No photos to save.');\r\n      return;\r\n    }\r\n\r\n    photos.forEach((photo, index) => {\r\n      console.log(index);\r\n      const link = document.createElement('a');\r\n      link.href = URL.createObjectURL(photo);\r\n      link.download = photo.name;\r\n      link.click();\r\n      URL.revokeObjectURL(link.href);\r\n    });\r\n\r\n    alert(`${photos.length} photo(s) saved locally.`);\r\n  };\r\n\r\n  const deletePhoto = (index) => {\r\n    updatePhotos((prevPhotos) => prevPhotos.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const sendViaWhatsApp = () => {\r\n    // Trim and validate inputs\r\n\r\n    const ownerPhoneNumber = data.ownerPhoneNumber?.trim();\r\n    const vehicleRegNo = data.vehicleRegNo?.trim();\r\n\r\n    if (!ownerPhoneNumber) {\r\n      alert('Please fill in the Owner Phone number.');\r\n      return;\r\n    }\r\n    if (!vehicleRegNo) {\r\n      alert('Please fill in the Vehicle Registration Number.');\r\n      return;\r\n    }\r\n\r\n    // Prepare the message\r\n    const fullMessage = `Greetings from CarSquare. Please find attached your car ${vehicleRegNo} images`;\r\n    const url = `https://api.whatsapp.com/send?phone=91${ownerPhoneNumber}&text=${encodeURIComponent(fullMessage)}`;\r\n\r\n    // Redirect to WhatsApp\r\n    window.open(url, '_blank');\r\n  };\r\n\r\n  const handleVehicleRegNoChange = (event) => {\r\n    const updatedData = { ...data, vehicleRegNo: event.target.value.toUpperCase() };\r\n    updateData(updatedData);\r\n  };\r\n  const handleVehicleNameChange = (event) => {\r\n    const updatedData = { ...data, vehicleName: event.target.value };\r\n    updateData(updatedData);\r\n  };\r\n  const handleKMsChange = (event) => {\r\n    const updatedData = { ...data, kiloMeters: event.target.value };\r\n    updateData(updatedData);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <MainCard title=\"Job Card Vehicle Details\">\r\n        <Grid container direction=\"row\" spacing={gridSpacing}>\r\n          <Grid item xs={4}>\r\n            <TextField\r\n              label=\"Vehicle Reg. No.\"\r\n              required\r\n              variant=\"outlined\"\r\n              value={data.vehicleRegNo || ''}\r\n              onChange={handleVehicleRegNoChange}\r\n            />\r\n          </Grid>\r\n          <Grid item xs={4}>\r\n            <TextField label=\"Vehicle Name\" required variant=\"outlined\" value={data.vehicleName || ''} onChange={handleVehicleNameChange} />\r\n          </Grid>\r\n          <Grid item xs={4}>\r\n            <TextField label=\"Vehicle K.Ms\" variant=\"outlined\" value={data.kiloMeters || ''} onChange={handleKMsChange} />\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Typography variant=\"h6\">Take Photos</Typography>\r\n          </Grid>\r\n\r\n          <Grid item xs={12}>\r\n            {!isCapturing ? (\r\n              <Grid container direction=\"row\" spacing={gridSpacing}>\r\n                <Grid item xs={6}>\r\n                  <Button variant=\"contained\" color=\"primary\" onClick={startCamera}>\r\n                    Start Camera\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    onClick={() => {\r\n                      setLoadPhotos(true);\r\n                      console.log(loadPhotos);\r\n                    }}\r\n                  >\r\n                    Load photos\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            ) : (\r\n              <>\r\n                <video\r\n                  id=\"camera-preview\"\r\n                  autoPlay\r\n                  playsInline\r\n                  style={{\r\n                    width: '100%',\r\n                    height: 'auto',\r\n                    border: '1px solid #ccc'\r\n                  }}\r\n                  ref={(video) => {\r\n                    if (video && stream) video.srcObject = stream;\r\n                  }}\r\n                  // eslint-disable-next-line jsx-a11y/media-has-caption\r\n                />\r\n                <Button variant=\"contained\" color=\"secondary\" onClick={capturePhoto} style={{ margin: '10px' }}>\r\n                  Capture Photo\r\n                </Button>\r\n                <Button variant=\"outlined\" onClick={stopCamera}>\r\n                  Stop Camera\r\n                </Button>\r\n              </>\r\n            )}\r\n          </Grid>\r\n\r\n          <Grid item xs={12}>\r\n            {photos.length > 0 && (\r\n              <Box>\r\n                <Typography variant=\"body1\">{photos.length} photo(s) captured.</Typography>\r\n                <Grid container spacing={2}>\r\n                  {photos.map((photo, index) => (\r\n                    <Grid item key={index} xs={12} sm={6} md={4} style={{ textAlign: 'center' }}>\r\n                      <img\r\n                        src={URL.createObjectURL(photo)}\r\n                        alt={`Captured ${index + 1}`}\r\n                        style={{\r\n                          width: '100%',\r\n                          height: 'auto',\r\n                          maxHeight: '200px',\r\n                          objectFit: 'contain',\r\n                          border: '1px solid #ccc',\r\n                          marginBottom: '10px'\r\n                        }}\r\n                      />\r\n                      <IconButton color=\"error\" onClick={() => deletePhoto(index)} aria-label=\"delete photo\">\r\n                        <DeleteIcon />\r\n                      </IconButton>\r\n                    </Grid>\r\n                  ))}\r\n                </Grid>\r\n              </Box>\r\n            )}\r\n          </Grid>\r\n\r\n          <Grid item xs={6}>\r\n            <Button variant=\"contained\" color=\"primary\" onClick={savePhotos} disabled={photos.length === 0}>\r\n              Save Photos Locally\r\n            </Button>\r\n          </Grid>\r\n          <Grid item xs={6}>\r\n            <Button variant=\"contained\" color=\"primary\" onClick={sendViaWhatsApp} disabled={photos.length === 0}>\r\n              Send via WhatsApp\r\n            </Button>\r\n          </Grid>\r\n        </Grid>\r\n      </MainCard>\r\n    </>\r\n  );\r\n};\r\n\r\nJobCarDetails.propTypes = {\r\n  data: PropTypes.object.isRequired,\r\n  updateData: PropTypes.func.isRequired,\r\n  photos: PropTypes.array,\r\n  updatePhotos: PropTypes.func,\r\n  zipFile: PropTypes.object\r\n};\r\nexport default JobCarDetails;\r\n","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"\n}), 'Delete');\nexports.default = _default;"],"names":["_ref","data","updateData","photos","updatePhotos","zipFile","isCapturing","setIsCapturing","useState","stream","setStream","loadPhotos","setLoadPhotos","useEffect","async","jszip","JSZip","zip","loadAsync","files","forEach","relativePath","file","fileBlob","push","File","type","console","log","unzipPhotos","_jsx","_Fragment","children","MainCard","title","_jsxs","Grid","container","direction","spacing","gridSpacing","item","xs","TextField","label","required","variant","value","vehicleRegNo","onChange","event","updatedData","target","toUpperCase","vehicleName","kiloMeters","Typography","id","autoPlay","playsInline","style","width","height","border","ref","video","srcObject","Button","color","onClick","videoElement","document","querySelector","canvas","createElement","videoWidth","videoHeight","getContext","drawImage","photoBlob","Promise","resolve","toBlob","prevPhotos","length","margin","stopCamera","getTracks","track","stop","mediaStream","navigator","mediaDevices","getUserMedia","facingMode","error","alert","Box","map","photo","index","sm","md","textAlign","src","URL","createObjectURL","alt","maxHeight","objectFit","marginBottom","IconButton","filter","_","i","deletePhoto","DeleteIcon","savePhotos","link","href","download","name","click","revokeObjectURL","disabled","sendViaWhatsApp","_data$ownerPhoneNumbe","_data$vehicleRegNo","ownerPhoneNumber","trim","url","encodeURIComponent","window","open","_interopRequireDefault","require","exports","_createSvgIcon","_jsxRuntime","_default","default","jsx","d"],"sourceRoot":""}