{"version":3,"file":"static/js/242.a485cfcc.chunk.js","mappings":"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","sources":["views/estimate/EstimateReports.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Bar } from 'react-chartjs-2';\r\nimport { getRequest } from 'utils/fetchRequest';\r\nimport { Tabs, Tab, Typography, Grid, Button } from '@mui/material';\r\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\r\nimport dayjs from 'dayjs';\r\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend } from 'chart.js';\r\nimport MainCard from 'ui-component/cards/MainCard';\r\nimport isoWeek from 'dayjs/plugin/isoWeek';\r\ndayjs.extend(isoWeek);\r\n\r\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\r\n\r\nconst EstimateReports = () => {\r\n  const [estimateData, setEstimateData] = useState({});\r\n\r\n  const [tabValue, setTabValue] = useState(0);\r\n\r\n  const [startDate, setStartDate] = useState(dayjs().subtract(7, 'day')); // Default: Last 7 days\r\n  const [endDate, setEndDate] = useState(dayjs()); // Default: Today\r\n\r\n  useEffect(() => {\r\n    fetchEstimateData('daily', dayjs().format('YYYY-MM-DD'));\r\n  }, []);\r\n\r\n  const fetchEstimateData = async (type, param) => {\r\n    try {\r\n      const url = `${process.env.REACT_APP_API_URL}/estimate/report/${type}/${param}`;\r\n      const data = await getRequest(url);\r\n      setEstimateData(data);\r\n    } catch (err) {\r\n      console.error('Error fetching estimate data:', err);\r\n    }\r\n  };\r\n\r\n  const fetchDateRangeData = async () => {\r\n    try {\r\n      const url = `${process.env.REACT_APP_API_URL}/estimate/report/daterange?startDate=${startDate.format(\r\n        'YYYY-MM-DD'\r\n      )}&endDate=${endDate.format('YYYY-MM-DD')}`;\r\n      const data = await getRequest(url);\r\n      setEstimateData(data);\r\n    } catch (err) {\r\n      console.error('Error fetching estimate data:', err);\r\n    }\r\n  };\r\n\r\n  const handleTabChange = (event, newValue) => {\r\n    setTabValue(newValue);\r\n\r\n    let param;\r\n    const today = dayjs();\r\n    const year = today.year();\r\n    const month = today.month() + 1;\r\n    const date = today.format('YYYY-MM-DD');\r\n    const week = today.isoWeek();\r\n\r\n    switch (newValue) {\r\n      case 0:\r\n        param = date;\r\n        break;\r\n      case 1:\r\n        param = `${year}/${week}`;\r\n        break;\r\n      case 2:\r\n        param = `${year}/${month}`;\r\n        break;\r\n      case 3:\r\n        param = `${year}`;\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n\r\n    fetchEstimateData(newValue === 0 ? 'daily' : newValue === 1 ? 'weekly' : newValue === 2 ? 'monthly' : 'yearly', param);\r\n  };\r\n\r\n  const generateTotalEstimateChart = () => {\r\n    return {\r\n      labels: ['Total Estimate Amount'],\r\n      datasets: [\r\n        {\r\n          label: 'Total',\r\n          data: [estimateData.total || 0],\r\n          backgroundColor: ['#3e95cd']\r\n        }\r\n      ]\r\n    };\r\n  };\r\n\r\n  const generateByPendingAmount = () => {\r\n    return {\r\n      labels: ['Total Credit Pending Amount'],\r\n      datasets: [\r\n        {\r\n          label: 'Credit',\r\n          data: [estimateData.byCredit || 0],\r\n          backgroundColor: ['#8e5ea2']\r\n        }\r\n      ]\r\n    };\r\n  };\r\n\r\n  const generateByCreditOrNotJobs = () => {\r\n    const byCredit = estimateData.byCredit || {};\r\n    const labels = Object.keys(byCredit);\r\n    const values = Object.values(byCredit);\r\n\r\n    return {\r\n      labels,\r\n      datasets: [\r\n        {\r\n          label: 'Credit/Not Jobs',\r\n          data: values,\r\n          backgroundColor: labels.map(() => '#3cba9f')\r\n        }\r\n      ]\r\n    };\r\n  };\r\n\r\n  return (\r\n    <MainCard title=\"Estimate Report\">\r\n      <Grid container spacing={2}>\r\n        {/* Date Range Picker */}\r\n        <Grid item lg={5} md={5} sm={5} xs={5}>\r\n          <DatePicker label=\"Start Date\" value={startDate} onChange={(newValue) => setStartDate(newValue)} />\r\n        </Grid>\r\n        <Grid item lg={5} md={5} sm={5} xs={5}>\r\n          <DatePicker label=\"End Date\" value={endDate} onChange={(newValue) => setEndDate(newValue)} />\r\n        </Grid>\r\n        <Grid item lg={2} md={2} sm={2} xs={2}>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={() => {\r\n              fetchDateRangeData();\r\n            }}\r\n          >\r\n            Get Estimate\r\n          </Button>\r\n        </Grid>\r\n        {/* Tabs for predefined filters */}\r\n        <Grid item lg={12} md={12} sm={12} xs={12}>\r\n          <Typography variant=\"h2\">Estimate</Typography>\r\n          <Tabs value={tabValue} onChange={handleTabChange}>\r\n            <Tab label=\"Daily\" />\r\n            <Tab label=\"Weekly\" />\r\n            <Tab label=\"Monthly\" />\r\n            <Tab label=\"Yearly\" />\r\n          </Tabs>\r\n        </Grid>\r\n\r\n        {/* Chart */}\r\n        <Grid item xs={12} md={4}>\r\n          <Typography variant=\"h6\">Total Estimate Amount</Typography>\r\n          <Bar data={generateTotalEstimateChart()} />\r\n        </Grid>\r\n        <Grid item xs={12} md={4}>\r\n          <Typography variant=\"h6\">By Credit Pending Amount</Typography>\r\n          <Bar data={generateByPendingAmount()} />\r\n        </Grid>\r\n        <Grid item xs={12} md={4}>\r\n          <Typography variant=\"h6\">Credit/Not Jobs</Typography>\r\n          <Bar data={generateByCreditOrNotJobs()} />\r\n        </Grid>\r\n      </Grid>\r\n    </MainCard>\r\n  );\r\n};\r\n\r\nexport default EstimateReports;\r\n"],"names":["dayjs","isoWeek","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","EstimateReports","estimateData","setEstimateData","useState","tabValue","setTabValue","startDate","setStartDate","subtract","endDate","setEndDate","useEffect","fetchEstimateData","format","async","type","param","url","data","getRequest","err","console","error","_jsx","MainCard","title","children","_jsxs","Grid","container","spacing","item","lg","md","sm","xs","DatePicker","label","value","onChange","newValue","Button","variant","color","onClick","fetchDateRangeData","Typography","Tabs","handleTabChange","event","today","year","month","date","week","Tab","Bar","labels","datasets","total","backgroundColor","byCredit","generateByCreditOrNotJobs","Object","keys","values","map"],"sourceRoot":""}